<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>boot.sh — terminal</title>
  <meta name="description" content="A fun fake terminal that types and runs 'code' when someone clicks your link." />
  <style>
    :root{
      --bg:#0b0f14;          /* dark background */
      --fg:#cfe3ff;          /* main text */
      --muted:#7c8aa0;       /* secondary */
      --accent:#79ffa8;      /* green */
      --accent2:#7ab7ff;     /* blue */
      --error:#ff6b6b;       /* red */
      --win:#0e141b;         /* window */
      --dot1:#ff5f56; --dot2:#ffbd2e; --dot3:#27c93f;
      --font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
    html,body{height:100%;}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:var(--font);overflow:hidden;}

    /* Matrix theme background */
    canvas#matrix{position:fixed;inset:0;z-index:0;display:none;}

    .shell{
      position:relative;z-index:1;max-width:980px;margin:6vh auto;padding:0 16px;
    }
    .window{
      box-shadow:0 10px 30px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.02);
      border:1px solid rgba(255,255,255,.08);
      border-radius:18px;overflow:hidden;background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
    }
    .titlebar{display:flex;align-items:center;gap:8px;padding:10px 12px;background:rgba(255,255,255,.03);}
    .dot{width:12px;height:12px;border-radius:50%;}
    .dot.red{background:var(--dot1);} .dot.yellow{background:var(--dot2);} .dot.green{background:var(--dot3);} 
    .title{margin-left:8px;color:var(--muted);font-size:12px;letter-spacing:.4px}
    .screen{height:72vh;overflow:auto;padding:18px 18px 28px 18px;background:radial-gradient(1200px 600px at 50% 0%, rgba(121,255,168,.06), transparent 60%);
      scrollbar-width:thin;scrollbar-color: rgba(255,255,255,.1) transparent;
    }
    .screen::-webkit-scrollbar{height:8px;width:8px}
    .screen::-webkit-scrollbar-thumb{background:rgba(255,255,255,.12);border-radius:20px}
    .prompt{color:var(--accent);}
    .line{white-space:pre-wrap;word-break:break-word;line-height:1.4;}
    .muted{color:var(--muted)}
    .ok{color:var(--accent)}
    .err{color:var(--error)}
    .cursor{display:inline-block;width:8px;background:var(--fg);margin-left:2px;animation:blink 1s steps(1) infinite;height:1em;vertical-align:-2px}
    @keyframes blink{50%{opacity:0}}
    .footer{margin-top:10px;color:var(--muted);font-size:12px;text-align:center}
    .kbd{padding:2px 6px;border:1px solid rgba(255,255,255,.2);border-radius:6px}

    /* Light theme */
    body.light{--bg:#f6f7fb;--fg:#0c0f14;--muted:#5b6675;--win:#ffffff;}
    body.light .window{background:#fff}

    /* Matrix theme tweaks */
    body.matrix{--bg:#000;--fg:#d7ffd7;--muted:#9fd69f;--accent:#00ff7f}
    body.matrix canvas#matrix{display:block}
  </style>
</head>
<body>
  <canvas id="matrix"></canvas>
  <div class="shell">
    <div class="window">
      <div class="titlebar">
        <div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div>
        <div class="title">/bin/boot.sh — terminal</div>
      </div>
      <div id="screen" class="screen" aria-live="polite" aria-atomic="false"></div>
    </div>
    <div class="footer">Tip: add <span class="kbd">?name=YourName&theme=matrix&msg=Hello</span> to the URL to customize.</div>
  </div>

  <script>
  // --- URL params ---
  const params = new URLSearchParams(location.search);
  const NAME = params.get('name') || 'guest';
  const THEME = (params.get('theme')||'dark').toLowerCase(); // dark | light | matrix
  const SPEED = Math.max(2, Math.min(50, +(params.get('speed')||16))); // lower=faster
  const MSG   = params.get('msg') || 'Welcome!';

  if(THEME === 'light') document.body.classList.add('light');
  if(THEME === 'matrix') document.body.classList.add('matrix');

  // --- Matrix background ---
  (function matrixRain(){
    if(THEME !== 'matrix') return;
    const c = document.getElementById('matrix');
    const ctx = c.getContext('2d');
    function size(){ c.width = innerWidth; c.height = innerHeight; }
    size(); addEventListener('resize', size);
    const fontSize = 16;
    let columns = Math.floor(c.width / fontSize);
    let drops = Array(columns).fill(1);
    function draw(){
      ctx.fillStyle = 'rgba(0,0,0,0.06)';
      ctx.fillRect(0,0,c.width,c.height);
      ctx.fillStyle = '#0f0';
      ctx.font = fontSize+'px monospace';
      for(let i=0;i<drops.length;i++){
        const text = String.fromCharCode(0x30A0 + Math.random()*96);
        ctx.fillText(text, i*fontSize, drops[i]*fontSize);
        if(drops[i]*fontSize > c.height && Math.random()>0.975){drops[i]=0}
        drops[i]++;
      }
      requestAnimationFrame(draw);
    }
    draw();
  })();

  const screen = document.getElementById('screen');

  // Utility: auto-scroll to bottom
  const autoscroll = () => screen.scrollTop = screen.scrollHeight;

  // Append a line to screen
  function appendLine(html){
    const div = document.createElement('div');
    div.className = 'line';
    div.innerHTML = html;
    screen.appendChild(div); autoscroll();
    return div;
  }

  // Typewriter effect for a single string
  function typeLine(target, text, cb){
    let i = 0;
    const cursor = document.createElement('span');
    cursor.className = 'cursor';
    target.appendChild(cursor);
    const timer = setInterval(()=>{
      target.insertBefore(document.createTextNode(text[i]||''), cursor);
      i++;
      autoscroll();
      if(i > text.length){
        clearInterval(timer);
        cursor.remove();
        cb && cb();
      }
    }, SPEED);
  }

  // Simulated progress bar
  function progressLine(label, doneCb){
    const row = appendLine(`<span class="muted">${label}</span> [          ] 0%`);
    let pct = 0;
    const t = setInterval(()=>{
      pct += Math.floor(Math.random()*8)+2; // 2-9%
      if(pct>100) pct=100;
      const filled = Math.floor(pct/10);
      const bar = '[' + '='.repeat(filled) + ' '.repeat(10-filled) + ']';
      row.innerHTML = `<span class="muted">${label}</span> ${bar} ${pct}%`;
      autoscroll();
      if(pct>=100){ clearInterval(t); doneCb && setTimeout(doneCb, 250); }
    }, 160 + Math.random()*200);
  }

  // Fake log generator (hex gibberish)
  function hexLine(prefix=''){ 
    const bytes = Array.from({length: 12}, () => Math.floor(Math.random()*256));
    return `${prefix}${bytes.map(b=>b.toString(16).padStart(2,'0')).join(' ')}\n`;
  }

  // Scenario script
  const script = [
    {type:'type', text:`\n$ whoami\n`},
    {type:'type', text:`${NAME}\n`},
    {type:'type', text:`$ hostname\n`},
    {type:'type', text:`edge-node-01\n`},
    {type:'type', text:`$ echo \"booting dev environment...\"\n`},
    {type:'type', text:`booting dev environment...\n`},
    {type:'progress', label:'Downloading dependencies'},
    {type:'type', text: hexLine('> ') + hexLine('> ') + hexLine('> ')},
    {type:'progress', label:'Starting containers'},
    {type:'type', text:`$ git clone https://example.com/${NAME}/secret.git\n`},
    {type:'type', text:`Cloning into 'secret'...\nremote: Enumerating objects: 42, done.\n`},
    {type:'progress', label:'Building project'},
    {type:'type', text:`$ npm run build\n`},
    {type:'type', text:`✔ Compiled successfully at ${new Date().toLocaleTimeString()}\n`},
    {type:'progress', label:'Provisioning AI models'},
    {type:'type', text:`$ python train.py --epochs 3\nEpoch 1/3 — loss: 0.${Math.floor(Math.random()*9)}${Math.floor(Math.random()*9)} acc: 9${Math.floor(Math.random()*9)}%\nEpoch 2/3 — loss: 0.${Math.floor(Math.random()*9)}${Math.floor(Math.random()*9)} acc: 9${Math.floor(Math.random()*9)}%\nEpoch 3/3 — loss: 0.${Math.floor(Math.random()*9)}${Math.floor(Math.random()*9)} acc: 9${Math.floor(Math.random()*9)}%\n`},
    {type:'type', text:`$ curl -s https://api.example.dev/ping\n200 OK\n`},
    {type:'progress', label:'Deploying to edge'},
    {type:'type', text:`$ echo \"${MSG}\"\n`},
    {type:'type', text:`${MSG}\n`},
    {type:'type', text:`$ echo \"Done. Press ⌘+L to copy the URL.\"\n`},
  ];

  // Play the script
  (function play(i=0){
    if(i>=script.length) return;
    const step = script[i];
    if(step.type==='type'){
      const el = appendLine('');
      typeLine(el, step.text, ()=>play(i+1));
    } else if(step.type==='progress'){
      progressLine(step.label, ()=>play(i+1));
    } else {
      play(i+1);
    }
  })();
  </script>
</body>
</html>
